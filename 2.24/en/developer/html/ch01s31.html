<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>1.31.&nbsp;Plugins</title><link rel="stylesheet" type="text/css" href="resources/css/docbook_bsd.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="dhis2_developer_manual.html" title="DHIS2 Developer Manual"><link rel="up" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Web API"><link rel="prev" href="ch01s30.html" title="1.30.&nbsp;Viewing analytical resource representations"><link rel="next" href="ch01s32.html" title="1.32.&nbsp;SQL views"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1.31.&nbsp;Plugins</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01s30.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;1.&nbsp;Web API</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch01s32.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6771"></a>1.31.&nbsp;Plugins</h2></div></div></div><p>DHIS2 comes with plugins which enables you to embed live data directly in your web portal
      or web site. Currently, plugins exist for charts, maps and pivot tables.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6776"></a>1.31.1.&nbsp;Embedding pivot tables with the Pivot Table plug-in</h3></div></div></div><p>In this example we will see how we can embed good-looking, light-weight html pivot
        tables with data served from a DHIS2 back-end into a Web page. To accomplish this we will use
        the Pivot table plug-in. The plug-in is written in Javascript and depends on the Ext JS
        library only. A complete working example can be found at <a class="link" href="http://play.dhis2.org/portal/table.html" target="_top">http://play.dhis2.org/portal/table.html</a>. Open the page in a web browser and
        view the source to see how it is set up.</p><p>We start by having a look at what the complete html file could look like. This setup
        puts two tables in our web page. The first one is referring to an existing table. The second
        is configured inline.
        </p><pre class="screen">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
  &lt;script src="https://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
  &lt;script src="https://dhis2-cdn.org/v215/plugin/table.js"&gt;&lt;/script&gt;

  &lt;script&gt;
    var base = "https://play.dhis2.org/demo";

    // Login - if OK, call the setLinks function

    Ext.onReady( function() {
      Ext.Ajax.request({
        url: base + "dhis-web-commons-security/login.action",
        method: "POST",
        params: { j_username: "portal", j_password: "Portal123" },
        success: setLinks
      });
    });

    function setLinks() {

      // Referring to an existing table through the id parameter, render to "table1" div

      DHIS.getTable({ url: base, el: "table1", id: "R0DVGvXDUNP" });

      // Full table configuration, render to "table2" div

      DHIS.getTable({
        url: base,
        el: "table2",
        columns: [
          {dimension: "de", items: [{id: "YtbsuPPo010"}, {id: "l6byfWFUGaP"}]}
        ],
        rows: [
          {dimension: "pe", items: [{id: "LAST_12_MONTHS"}]}
        ],
        filters: [
          {dimension: "ou", items: [{id: "USER_ORGUNIT"}]}
        ],
        // All following options are optional
        showTotals: false,
        showSubTotals: false,
        hideEmptyRows: true,
        showHierarchy: true,
        displayDensity: "comfortable",
        fontSize: "large",
        digitGroupSeparator: "comma",
        legendSet: {id: "BtxOoQuLyg1"}
      });
    }
  &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;div id="table1"&gt;&lt;/div&gt;
  &lt;div id="table2"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p>
      </p><p>Three files are included in the header section of the HTML document. The first two files
        are the Ext JS javascript library (we use the DHIS2 content delivery network in this case)
        and its css stylesheet. The third file is the Pivot table plug-in. Make sure the path is
        pointing to your DHIS2 server installation.</p><pre class="screen">&lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
&lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
&lt;script src="http://dhis2-cdn.org/v215/plugin/table.js"&gt;&lt;/script&gt;</pre><p>To authenticate with the DHIS2 server we use the same approach as in the previous
        section. In the header of the HTML document we include the following Javascript inside a
        script element. The <span class="italic">setLinks</span> method will be implemented
        later. Make sure the <span class="italic">base</span> variable is pointing to your
        DHIS2 installation.</p><pre class="screen">var base = "https://play.dhis2.org/demo/";

Ext.onReady( function() {
  Ext.Ajax.request({
    url: base + "dhis-web-commons-security/login.action",
    method: "POST",
    params: { j_username: "portal", j_password: "Portal123" },
      success: setLinks
  });
});</pre><p>Now let us have a look at the various options for the Pivot table plug-in. Two properies
        are required: <span class="italic">el</span> and <span class="italic">url</span> (please refer to the table below). Now, if you want to refer to
        pre-defined tables already made inside DHIS2 it is sufficient to provide the additional
          <span class="italic">id</span> parameter. If you instead want to configure a pivot
        table dynamically you shoud omit the id parameter and provide data dimensions inside a
          <span class="italic">columns</span> array, a <span class="italic">rows</span> array and optionally a <span class="italic">filters</span> array
        instead.</p><p>A data dimension is defined as an object with a text property called <span class="italic">dimension</span>. This property accepts the following values: <span class="italic">in</span> (indicator), <span class="italic">de</span> (data
        element), <span class="italic">ds</span> (data set), <span class="italic">dc</span> (data element operand), <span class="italic">pe</span> (period),
          <span class="italic">ou</span> (organisation unit) or the id of any organisation
        unit group set or data element group set (can be found in the web api). The data dimension
        also has an array property called <span class="italic">items</span> which accepts
        objects with an <span class="italic">id</span> property.</p><p>To sum up, if you want to have e.g. "ANC 1 Coverage", "ANC 2
        Coverage" and "ANC 3 Coverage" on the columns in your table you can make the
        following <span class="italic">columns</span> config:</p><pre class="screen">columns: [{
  dimension: "in", // "in", "de", "ds", "dc", "pe", "ou" or any dimension id
  items: [
    {id: "Uvn6LCg7dVU"}, // the id of ANC 1 Coverage
    {id: "OdiHJayrsKo"}, // the id of ANC 2 Coverage
    {id: "sB79w2hiLp8"}  // the id of ANC 3 Coverage
  ]
}]</pre><div class="table"><a name="d0e6858"></a><p class="title"><b>Table&nbsp;1.57.&nbsp;Pivot table plug-in configuration</b></p><div class="table-contents"><table class="table" summary="Pivot table plug-in configuration" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> Param </th><th> Type </th><th> Required </th><th> Options (default first) </th><th> Description </th></tr></thead><tbody><tr><td>el</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Identifier of the HTML element to render the table in your web page</td></tr><tr><td>url</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Base URL of the DHIS2 server</td></tr><tr><td>id</td><td>string</td><td>No</td><td>&nbsp;</td><td>Identifier of a pre-defined table (favorite) in DHIS</td></tr><tr><td>columns</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Data dimensions to include in table as columns</td></tr><tr><td>rows</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Data dimensions to include in table as rows</td></tr><tr><td>filter</td><td>array</td><td>No</td><td>&nbsp;</td><td>Data dimensions to include in table as filters</td></tr><tr><td>showTotals</td><td>boolean</td><td>No</td><td>true | false</td><td>Whether to display totals for columns and rows</td></tr><tr><td>showSubTotals</td><td>boolean</td><td>No</td><td>true | false</td><td>Whether to display sub-totals for columns and rows</td></tr><tr><td>hideEmptyRows</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to hide rows with no data</td></tr><tr><td>showHierarchy</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to extend orgunit names with the name of all anchestors</td></tr><tr><td>displayDensity</td><td>string</td><td>No</td><td>"normal" | "comfortable" | "compact"</td><td>The amount of space inside table cells</td></tr><tr><td>fontSize</td><td>string</td><td>No</td><td>"normal" | "large" | "small"</td><td>Table font size</td></tr><tr><td>digitGroupSeparator</td><td>string</td><td>No</td><td>"space" | "comma" | "none"</td><td>How values are formatted: 1 000 | 1,000 | 1000</td></tr><tr><td>legendSet</td><td>object</td><td>No</td><td>&nbsp;</td><td>Show a color indicator next to the values (currently reusing legend sets from
                GIS)</td></tr><tr><td>userOrgUnit</td><td>string / array</td><td>No</td><td>&nbsp;</td><td>Organisation unit identifiers, overrides organisation units associated with
                curretn user, single or array</td></tr></tbody></table></div></div><br class="table-break"><p>We continue by adding one pre-defined and one dynamic pivot table to our HTML document.
        You can browse the list of available pivot tables using the Web API here: <a class="link" href="http://play.dhis2.org/demo/api/24/reportTables" target="_top">http://play.dhis2.org/demo/api/24/reportTables</a>.</p><pre class="screen">function setLinks() {
  DHIS.getTable({ url: base, el: "table1", id: "R0DVGvXDUNP" });

  DHIS.getTable({
 url: base,
 el: "table2",
 columns: [
   {dimension: "de", items: [{id: "YtbsuPPo010"}, {id: "l6byfWFUGaP"}]}
 ],
 rows: [
   {dimension: "pe", items: [{id: "LAST_12_MONTHS"}]}
 ],
 filters: [
   {dimension: "ou", items: [{id: "USER_ORGUNIT"}]}
 ],
 // All following options are optional
 showTotals: false,
 showSubTotals: false,
 hideEmptyRows: true,
 showHierarchy: true,
 displayDensity: "comfortable",
 fontSize: "large",
 digitGroupSeparator: "comma",
 legendSet: {id: "BtxOoQuLyg1"}
  });
}</pre><p>Finally we include some <span class="italic">div</span> elements in the body
        section of the HTML document with the identifiers referred to in the plug-in
        Javascript.</p><pre class="screen">&lt;div id="table1"&gt;&lt;/div&gt;
&lt;div id="table2"&gt;&lt;/div&gt;</pre><p>To see a complete working example please visit <a class="link" href="http://play.dhis2.org/portal/table.html" target="_top">http://play.dhis2.org/portal/table.html</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7049"></a>1.31.2.&nbsp;Embedding charts with the Visualizer chart plug-in</h3></div></div></div><p>In this example we will see how we can embed good-looking Ext JS charts (<a class="link" href="http://www.sencha.com/products/extjs" target="_top">http://www.sencha.com/products/extjs</a>) with data served from a DHIS2 back-end
        into a Web page. To accomplish this we will use the DHIS2 Visualizer plug-in. The plug-in is
        written in Javascript and depends on the Ext JS library only. A complete working example can
        be found at <a class="link" href="http://play.dhis2.org/portal/chart.html" target="_top">http://play.dhis2.org/portal/chart.html</a>. Open the page in a
        web browser and view the source to see how it is set up.</p><p>We start by having a look at what the complete html file could look like. This setup
        puts two charts in our web page. The first one is referring to an existing chart. The second
        is configured inline.
        </p><pre class="screen">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
  &lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
  &lt;script src="http://dhis2-cdn.org/v215/plugin/chart.js"&gt;&lt;/script&gt;

  &lt;script&gt;
    var base = "https://play.dhis2.org/demo";

    // Login - if OK, call the setLinks function

    Ext.onReady( function() {
      Ext.Ajax.request({
        url: base + "dhis-web-commons-security/login.action",
        method: "POST",
        params: { j_username: "portal", j_password: "Portal123" },
        success: setLinks
      });
    });

    function setLinks() {

      // Referring to an existing chart through the id parameter, render to "chart1" div

      DHIS.getChart({ url: base, el: "chart1", id: "R0DVGvXDUNP" });

      // Full chart configuration, render to "chart2" div

      DHIS.getChart({
        url: base,
        el: "chart2",
        type: "stackedBar",
        columns: [ // Chart series
          {dimension: "de", items: [{id: "YtbsuPPo010"}, {id: "l6byfWFUGaP"}]}
        ],
        rows: [ // Chart categories
          {dimension: "pe", items: [{id: "LAST_12_MONTHS"}]}
        ],
        filters: [
          {dimension: "ou", items: [{id: "USER_ORGUNIT"}]}
        ],
        // All following options are optional
        showData: false,
        targetLineValue: 70,
        baseLineValue: 20,
        showTrendLine: true,
        hideLegend: true,
        title: "My chart title",
        domainAxisTitle: "Periods",
        rangeAxisTitle: "Percent"
      });
    }
  &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;div id="chart1"&gt;&lt;/div&gt;
  &lt;div id="chart2"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p>
      </p><p>Three files are included in the header section of the HTML document. The first two files
        are the Ext JS javascript library (we use the DHIS2 content delivery network in this case)
        and its stylesheet. The third file is the Visualizer plug-in. Make sure the path is pointing
        to your DHIS2 server installation.</p><pre class="screen">&lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
&lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
&lt;script src="http://dhis2-cdn.org/v215/plugin/chart.js"&gt;&lt;/script&gt;</pre><p>To authenticate with the DHIS2 server we use the same approach as in the previous
        section. In the header of the HTML document we include the following Javascript inside a
        script element. The <span class="italic">setLinks</span> method will be implemented
        later. Make sure the <span class="italic">base</span> variable is pointing to your
        DHIS2 installation.</p><pre class="screen">var base = "https://play.dhis2.org/demo/";

Ext.onReady( function() {
  Ext.Ajax.request({
    url: base + "dhis-web-commons-security/login.action",
    method: "POST",
    params: { j_username: "portal", j_password: "Portal123" },
    success: setLinks
  });
});</pre><p>Now let us have a look at the various options for the Visualizer plug-in. Two properies
        are required: <span class="italic">el</span> and <span class="italic">url</span> (please refer to the table below). Now, if you want to refer to
        pre-defined charts already made inside DHIS2 it is sufficient to provide the additional
          <span class="italic">id</span> parameter. If you instead want to configure a chart
        dynamically you shoud omit the id parameter and provide data dimensions inside a <span class="italic">columns</span> array (chart series), a <span class="italic">rows</span> array (chart categories) and optionally a <span class="italic">filters</span> array instead.</p><p>A data dimension is defined as an object with a text property called <span class="italic">dimension</span>. This property accepts the following values: <span class="italic">in</span> (indicator), <span class="italic">de</span> (data
        element), <span class="italic">ds</span> (data set), <span class="italic">dc</span> (data element operand), <span class="italic">pe</span> (period),
          <span class="italic">ou</span> (organisation unit) or the id of any organisation
        unit group set or data element group set (can be found in the web api). The data dimension
        also has an array property called <span class="italic">items</span> which accepts
        objects with an <span class="italic">id</span> property.</p><p>To sum up, if you want to have e.g. "ANC 1 Coverage", "ANC 2
        Coverage" and "ANC 3 Coverage" as series in your chart you can make the
        following <span class="italic">columns</span> config:</p><pre class="screen">columns: [{
  dimension: "in", // could be "in", "de", "ds", "dc", "pe", "ou" or any dimension id
  items: [
    {id: "Uvn6LCg7dVU"}, // the id of ANC 1 Coverage
    {id: "OdiHJayrsKo"}, // the id of ANC 2 Coverage
    {id: "sB79w2hiLp8"}  // the id of ANC 3 Coverage
  ]
}]</pre><div class="table"><a name="d0e7133"></a><p class="title"><b>Table&nbsp;1.58.&nbsp;Visualizer chart plug-in configuration</b></p><div class="table-contents"><table class="table" summary="Visualizer chart plug-in configuration" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> Param </th><th> Type </th><th> Required </th><th> Options (default first) </th><th> Description </th></tr></thead><tbody><tr><td>el</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Identifier of the HTML element to render the chart in your web page</td></tr><tr><td>url</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Base URL of the DHIS2 server</td></tr><tr><td>id</td><td>string</td><td>No</td><td>&nbsp;</td><td>Identifier of a pre-defined chart (favorite) in DHIS</td></tr><tr><td>type</td><td>string</td><td>No</td><td>column | stackedcolumn | bar | stackedbar | line | area | pie</td><td>Chart type</td></tr><tr><td>columns</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Data dimensions to include in chart as series</td></tr><tr><td>rows</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Data dimensions to include in chart as category</td></tr><tr><td>filter</td><td>array</td><td>No</td><td>&nbsp;</td><td>Data dimensions to include in chart as filters</td></tr><tr><td>showData</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to display data on the chart</td></tr><tr><td>showTrendLine</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to display trend line(s) on the chart</td></tr><tr><td>hideLegend</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to hide the chart legend</td></tr><tr><td>hideTitle</td><td>boolean</td><td>No</td><td>false | true</td><td>Whether to hide the chart title</td></tr><tr><td>targetLineValue</td><td>double</td><td>No</td><td>&nbsp;</td><td>Value of target line to display on the chart</td></tr><tr><td>targetLineLabel</td><td>string</td><td>No</td><td>&nbsp;</td><td>Label for target line</td></tr><tr><td>baseLineValue</td><td>double</td><td>No</td><td>&nbsp;</td><td>Value of baseline to display on the chart</td></tr><tr><td>baseLineLabel</td><td>string</td><td>No</td><td>&nbsp;</td><td>Label for baseline</td></tr><tr><td>domainAxisTitle</td><td>string</td><td>No</td><td>&nbsp;</td><td>Title for the domain axis</td></tr><tr><td>rangeAxisTitle</td><td>string</td><td>No</td><td>&nbsp;</td><td>Title for the range axis</td></tr><tr><td>width</td><td>integer</td><td>No</td><td>&nbsp;</td><td>Width of chart</td></tr><tr><td>height</td><td>integer</td><td>No</td><td>&nbsp;</td><td>Height of chart</td></tr><tr><td>userOrgUnit</td><td>string / array</td><td>No</td><td>&nbsp;</td><td>Organisation unit identifiers, overrides organisation units associated with
                curretn user, single or array</td></tr></tbody></table></div></div><br class="table-break"><p>We continue by including two pre-defined charts and to dynamic charts to our HTML
        document. You can browse the list of available charts using the Web API here: <a class="link" href="http://play.dhis2.org/demo/api/24/charts" target="_top">http://play.dhis2.org/demo/api/24/charts</a>.</p><pre class="screen">function setLinks() {
  DHIS.getChart({ url: base, el: "chart1", id: "R0DVGvXDUNP" });

  DHIS.getChart({
 url: base,
 el: "chart2",
 type: "stackedBar",
 columns: [ // Chart series
   {dimension: "de", items: [{id: "YtbsuPPo010"}, {id: "l6byfWFUGaP"}]}
 ],
 rows: [ // Chart categories
   {dimension: "pe", items: [{id: "LAST_12_MONTHS"}]}
 ],
 filters: [
   {dimension: "ou", items: [{id: "USER_ORGUNIT"}]}
 ],
 // All following options are optional
 showData: false,
 targetLineValue: 70,
 baseLineValue: 20,
 showTrendLine: true,
 hideLegend: true,
 title: "My chart title",
 domainAxisTitle: "Periods",
 rangeAxisTitle: "Percent"
  });
}</pre><p>Finally we include some <span class="italic">div</span> elements in the body
        section of the HTML document with the identifiers referred to in the plug-in
        Javascript.</p><pre class="screen">&lt;div id="chart1"&gt;&lt;/div&gt;
&lt;div id="chart2"&gt;&lt;/div&gt;
</pre><p>To see a complete working example please visit <a class="link" href="http://play.dhis2.org/portal/chart.html" target="_top">http://play.dhis2.org/portal/chart.html</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7372"></a>1.31.3.&nbsp;Embedding maps with the GIS map plug-in</h3></div></div></div><p>In this example we will see how we can embed maps with data served from a DHIS2 back-end
        into a Web page. To accomplish this we will use the GIS map plug-in. The plug-in is written
        in Javascript and depends on the Ext JS library only. A complete working example can be
        found at <a class="link" href="http://play.dhis2.org/portal/map.html" target="_top">http://play.dhis2.org/portal/map.html</a>. Open the page in a web
        browser and view the source to see how it is set up.</p><p>We start by having a look at what the complete html file could look like. This setup
        puts two maps in our web page. The first one is referring to an existing map. The second is
        configured inline.
        </p><pre class="screen">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
  &lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
  &lt;script src="https://maps.google.com/maps/api/js?sensor=false"&gt;&lt;/script&gt;
  &lt;script src="http://dhis2-cdn.org/v215/openlayers/OpenLayers.js"&gt;&lt;/script&gt;
  &lt;script src="http://dhis2-cdn.org/v215/plugin/map.js"&gt;&lt;/script&gt;

  &lt;script&gt;
    var base = "https://play.dhis2.org/demo";

    // Login - if OK, call the setLinks function

    Ext.onReady( function() {
      Ext.Ajax.request({
        url: base + "dhis-web-commons-security/login.action",
        method: "POST",
        params: { j_username: "portal", j_password: "Portal123" },
        success: setLinks
      });
    });

    function setLinks() {
      DHIS.getMap({ url: base, el: "map1", id: "ytkZY3ChM6J" });

      DHIS.getMap({
        url: base,
        el: "map2",
        mapViews: [{
          columns: [{dimension: "in", items: [{id: "Uvn6LCg7dVU"}]}], // data
          rows: [{dimension: "ou", items: [{id: "LEVEL-3"}, {id: "ImspTQPwCqd"}]}], // organisation units,
          filters: [{dimension: "pe", items: [{id: "LAST_3_MONTHS"}]}], // period
          // All following options are optional
          classes: 7,
          colorLow: "02079c",
          colorHigh: "e5ecff",
          opacity: 0.9,
          legendSet: {id: "fqs276KXCXi"}
        }]
      });
    }
  &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;div id="map1"&gt;&lt;/div&gt;
  &lt;div id="map2"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p>Four files and Google Maps are included in the header section of the HTML document. The
        first two files are the Ext JS javascript library (we use the DHIS2 content delivery
        network in this case) and its stylesheet. The third file is the OpenLayers javascript
        mapping framework (<a class="link" href="http://openlayers.org" target="_top">http://openlayers.org</a>) and finally we include the GIS
        map plug-in. Make sure the path is pointing to your DHIS2 server installation.</p><pre class="screen">&lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v215/ext/resources/css/ext-plugin-gray.css" /&gt;
&lt;script src="http://dhis2-cdn.org/v215/ext/ext-all.js"&gt;&lt;/script&gt;
&lt;script src="https://maps.google.com/maps/api/js?sensor=false"&gt;&lt;/script&gt;
&lt;script src="http://dhis2-cdn.org/v215/openlayers/OpenLayers.js"&gt;&lt;/script&gt;
&lt;script src="http://dhis2-cdn.org/v215/plugin/map.js"&gt;&lt;/script&gt;</pre><p>To authenticate with the DHIS2 server we use the same approach as in the previous
        section. In the header of the HTML document we include the following Javascript inside a
        script element. The <span class="italic">setLinks</span> method will be implemented
        later. Make sure the <span class="italic">base</span> variable is pointing to your
        DHIS2 installation.</p><pre class="screen">Ext.onReady( function() {
  Ext.Ajax.request({
    url: base + "dhis-web-commons-security/login.action",
    method: "POST",
    params: { j_username: "portal", j_password: "Portal123" },
    success: setLinks
  });
});</pre><p>Now let us have a look at the various options for the GIS plug-in. Two properies are
        required: <span class="italic">el</span> and <span class="italic">url</span>
        (please refer to the table below). Now, if you want to refer to pre-defined maps already
        made in the DHIS2 GIS it is sufficient to provide the additional <span class="italic">id</span> parameter. If you instead want to configure a map dynamically you shoud
        omit the id parameter and provide <span class="italic">mapViews</span> (layers)
        instead. They should be configured with data dimensions inside a <span class="italic">columns</span> array, a <span class="italic">rows</span> array and optionally
        a <span class="italic">filters</span> array instead.</p><p>A data dimension is defined as an object with a text property called <span class="italic">dimension</span>. This property accepts the following values: <span class="italic">in</span> (indicator), <span class="italic">de</span> (data
        element), <span class="italic">ds</span> (data set), <span class="italic">dc</span> (data element operand), <span class="italic">pe</span> (period),
          <span class="italic">ou</span> (organisation unit) or the id of any organisation
        unit group set or data element group set (can be found in the web api). The data dimension
        also has an array property called <span class="italic">items</span> which accepts
        objects with an <span class="italic">id</span> property.</p><p>To sum up, if you want to have a layer with e.g. "ANC 1 Coverage" in your map
        you can make the following <span class="italic">columns</span> config:</p><pre class="screen">columns: [{
  dimension: "in", // could be "in", "de", "ds", "dc", "pe", "ou" or any dimension id
  items: [{id: "Uvn6LCg7dVU"}], // the id of ANC 1 Coverage
}]</pre><div class="table"><a name="d0e7458"></a><p class="title"><b>Table&nbsp;1.59.&nbsp;GIS map plug-in configuration</b></p><div class="table-contents"><table class="table" summary="GIS map plug-in configuration" border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th> Param </th><th> Type </th><th> Required </th><th> Options (default first) </th><th> Description </th></tr></thead><tbody><tr><td>el</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Identifier of the HTML element to render the map in your web page</td></tr><tr><td>url</td><td>string</td><td>Yes</td><td>&nbsp;</td><td>Base URL of the DHIS2 server</td></tr><tr><td>id</td><td>string</td><td>No</td><td>&nbsp;</td><td>Identifier of a pre-defined map (favorite) in DHIS</td></tr><tr><td>baseLayer</td><td>string/boolean</td><td>No</td><td>'gs', 'googlestreets' | 'gh',
                'googlehybrid' | 'osm', 'openstreetmap' | false, null,
                'none', 'off'</td><td>Show background map</td></tr><tr><td>hideLegend</td><td>boolean</td><td>No</td><td>false | true</td><td>Hide legend panel</td></tr><tr><td>mapViews</td><td>array</td><td>Yes (if no id provided)</td><td>&nbsp;</td><td>Array of layers</td></tr></tbody></table></div></div><br class="table-break"><p>If no id is provided you must add map view objects with the following config
        options:</p><div class="table"><a name="d0e7539"></a><p class="title"><b>Table&nbsp;1.60.&nbsp;Map plug-in configuration</b></p><div class="table-contents"><table class="table" summary="Map plug-in configuration" border="1"><colgroup><col><col><col><col><col></colgroup><tbody><tr><td>layer</td><td>string</td><td>No</td><td>"thematic1" | "thematic2" | "thematic3" |
                "thematic4" | "boundary" | "facility" | </td><td>The layer to which the map view content should be added</td></tr><tr><td>columns</td><td>array</td><td>Yes</td><td>&nbsp;</td><td>Indicator, data element, data operand or data set (only one will be
                used)</td></tr><tr><td>rows</td><td>array</td><td>Yes</td><td>&nbsp;</td><td>Organisation units (multiple allowed)</td></tr><tr><td>filter</td><td>array</td><td>Yes</td><td>&nbsp;</td><td>Period (only one will be used)</td></tr><tr><td>classes</td><td>integer</td><td>No</td><td>5 | 1-7</td><td>The number of automatic legend classes</td></tr><tr><td>method</td><td>integer</td><td>No</td><td>2 | 3</td><td>Legend calculation method where 2 = equal intervals and 3 = equal
                counts</td></tr><tr><td>colorLow</td><td>string</td><td>No</td><td>"ff0000" (red) | Any hex color</td><td>The color representing the first automatic legend class</td></tr><tr><td>colorHigh</td><td>string</td><td>No</td><td>"00ff00" (green) | Any hex color</td><td>The color representing the last automatic legend class</td></tr><tr><td>radiusLow</td><td>integer</td><td>No</td><td>5 | Any integer</td><td>Only applies for facilities (points) - radius of the point with lowest
                value</td></tr><tr><td>radiusHigh</td><td>integer</td><td>No</td><td>15 | Any integer</td><td>Only applies for facilities (points) - radius of the point with highest
                value</td></tr><tr><td>opacity</td><td>double</td><td>No</td><td>0.8 | 0 - 1</td><td>Opacity/transparency of the layer content</td></tr><tr><td>legendSet</td><td>object</td><td>No</td><td>&nbsp;</td><td>Pre-defined legend set. Will override the automatic legend set.</td></tr><tr><td>labels</td><td>boolean/object</td><td>No</td><td>false | true | object properties: fontSize (integer), color (hex string),
                strong (boolean), italic (boolean)</td><td>Show labels on the map</td></tr><tr><td>width</td><td>integer</td><td>No</td><td>&nbsp;</td><td>Width of map</td></tr><tr><td>height</td><td>integer</td><td>No</td><td>&nbsp;</td><td>Height of map</td></tr><tr><td>userOrgUnit</td><td>string / array</td><td>No</td><td>&nbsp;</td><td>Organisation unit identifiers, overrides organisation units associated with
                curretn user, single or array</td></tr></tbody></table></div></div><br class="table-break"><p>We continue by adding one pre-defined and one dynamically configured map to our HTML
        document. You can browse the list of available maps using the Web API here: <a class="link" href="http://play.dhis2.org/demo/api/24/maps" target="_top">http://play.dhis2.org/demo/api/24/maps</a>.</p><pre class="screen">function setLinks() {
  DHIS.getMap({ url: base, el: "map1", id: "ytkZY3ChM6J" });

  DHIS.getMap({
 url: base,
 el: "map2",
 mapViews: [
   columns: [ // Chart series
  columns: [{dimension: "in", items: [{id: "Uvn6LCg7dVU"}]}], // data
   ],
   rows: [ // Chart categories
  rows: [{dimension: "ou", items: [{id: "LEVEL-3"}, {id: "ImspTQPwCqd"}]}], // organisation units
   ],
   filters: [
  filters: [{dimension: "pe", items: [{id: "LAST_3_MONTHS"}]}], // period
   ],
   // All following options are optional
   classes: 7,
   colorLow: "02079c",
   colorHigh: "e5ecff",
   opacity: 0.9,
   legendSet: {id: "fqs276KXCXi"}
 ]
  });
}</pre><p>Finally we include some <span class="italic">div</span> elements in the body
        section of the HTML document with the identifiers referred to in the plug-in
        Javascript.</p><pre class="screen">&lt;div id="map1"&gt;&lt;/div&gt;
&lt;div id="map2"&gt;&lt;/div&gt;</pre><p>To see a complete working example please visit <a class="link" href="http://play.dhis2.org/portal/map.html" target="_top">http://play.dhis2.org/portal/map.html</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7730"></a>1.31.4.&nbsp;Creating a chart carousel with the carousel plug-in</h3></div></div></div><p>The chart plug-in also makes it possible to create a chart carousel which for instance
        can be used to create an attractive front page on a Web portal. To use the carousel we need
        to import a few files in the head section of our HTML page:</p><pre class="screen">
&lt;link rel="stylesheet" type="text/css" href="http://dhis2-cdn.org/v213/ext/resources/css/ext-plugin-gray.css" /&gt;
&lt;link rel="stylesheet" type="text/css" href="https://play.dhis2.org/demo/dhis-web-commons/javascripts/ext-ux/carousel/css/carousel.css" /&gt;
&lt;script type="text/javascript" src="https://extjs-public.googlecode.com/svn/tags/extjs-4.0.7/release/ext-all.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="https://play.dhis2.org/demo/dhis-web-commons/javascripts/ext-ux/carousel/Carousel.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="https://play.dhis2.org/demo/dhis-web-commons/javascripts/plugin/plugin.js"&gt;&lt;/script&gt;</pre><p>The first file is the CSS stylesheet for the chart plug-in. The second file is the CSS
        stylesheet for the carousel widget. The third file is the Ext JavaScript framework which
        this plug-in depends on. The fourth file is the carousel plug-in JavaScript file. The fifth
        file is the chart plug-in JavaScript file. The paths in this example points at the DHIS2
        demo site, make sure you update them to point to your own DHIS2 installation.</p><p>Please refer to the section about the chart plug-in on how to do authentication.</p><p>To create a chart carousel we will first render the charts we want to include in the
        carousel using the method described in the chart plug-in section. Then we create the chart
        carousel itself. The charts will be rendered into <span class="italic">div</span>
        elements which all have a CSS class called <span class="italic">chart</span>. In the
        carousel configuration we can then define a <span class="italic">selector</span>
        expression which refers to those div elements like this:</p><pre class="screen">DHIS.getChart({ uid: 'R0DVGvXDUNP', el: 'chartA1', url: base });
DHIS.getChart({ uid: 'X0CPnV6uLjR', el: 'chartA2', url: base });
DHIS.getChart({ uid: 'j1gNXBgwKVm', el: 'chartA3', url: base });
DHIS.getChart({ uid: 'X7PqaXfevnL', el: 'chartA4', url: base });

new Ext.ux.carousel.Carousel( 'chartCarousel', {
  autoPlay: true,
  itemSelector: 'div.chart',
  interval: 5,
  showPlayButton: true
});</pre><p>The first argument in the configuration is the id of the div element in which you want
        to render the carousel. The <span class="italic">autoPlay</span> configuration option
        refers to whether we want the carousel to start when the user loads the Web page. The
          <span class="italic">interval</span> option defines how many seconds each chart
        should be displayed. The <span class="italic">showPlayButton</span> defines whether
        we want to render a button for the user to start and stop the carousel. Finally we need to
        insert the div elements in the body of the HTML document:</p><pre class="screen">&lt;div id="chartCarousel"&gt;

&lt;div id="chartA1"&gt;&lt;/div&gt;
&lt;div id="chartA2"&gt;&lt;/div&gt;
&lt;div id="chartA3"&gt;&lt;/div&gt;
&lt;div id="chartA4"&gt;&lt;/div&gt;</pre><p>To see a complete working example please visit <a class="link" href="http://play.dhis2.org/portal/carousel.html" target="_top">http://play.dhis2.org/portal/carousel.html</a>.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01s30.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch01.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch01s32.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">1.30.&nbsp;Viewing analytical resource representations&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="dhis2_developer_manual.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;1.32.&nbsp;SQL views</td></tr></table></div></body></html>