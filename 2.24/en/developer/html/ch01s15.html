<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>1.15.&nbsp;Metadata versioning</title><link rel="stylesheet" type="text/css" href="resources/css/docbook_bsd.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="dhis2_developer_manual.html" title="DHIS2 Developer Manual"><link rel="up" href="ch01.html" title="Chapter&nbsp;1.&nbsp;Web API"><link rel="prev" href="ch01s14.html" title="1.14.&nbsp;Metadata import"><link rel="next" href="ch01s16.html" title="1.16.&nbsp;Metadata Synchronization"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1.15.&nbsp;Metadata versioning</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01s14.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;1.&nbsp;Web API</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch01s16.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="metadata_sync_API"></a>1.15.&nbsp;Metadata versioning</h2></div></div></div><p>This section explains the Metadata  Versioning APIs available starting 2.24</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>/api/metadata/version	 - This api will return the current metadata version of the system on which it
          is invoked.</p></li></ul></div><div class="table"><a name="d0e2781"></a><p class="title"><b>Table&nbsp;1.22.&nbsp;Query Parameters</b></p><div class="table-contents"><table class="table" summary="Query Parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>Name</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>versionName</td><td>false</td><td>If this parameter is not specified, it will return the current version of the system or
              otherwise it will return the details of the versionName passed as parameter. (versionName is
              of the syntax "Version_&lt;id&gt;"</td></tr></tbody></table></div></div><br class="table-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2804"></a>1.15.1.&nbsp;Get metadata version details</h3></div></div></div><p><span class="bold"><strong>Example: Get the current metadata version of this system</strong></span></p><p><span class="bold"><strong>Sample request:</strong></span>
          </p><pre class="screen">curl -u admin:district "https://play.dhis2.org/dev/api/metadata/version"</pre><p><span class="bold"><strong>Sample response:</strong></span>
        </p><pre class="screen">{
    "name": "Version_4",
    "created": "2016-06-30T06:01:28.684+0000",
    "lastUpdated": "2016-06-30T06:01:28.685+0000",
    "externalAccess": false,
    "displayName": "Version_4",
    "type": "BEST_EFFORT",
    "hashCode": "848bf6edbaf4faeb7d1a1169445357b0",
    "id": "Ayz2AEMB6ry"
}</pre><p><span class="bold"><strong>Example: Get the details of version with name "Version_2"</strong></span></p><p><span class="bold"><strong>Sample request:</strong></span>
          </p><pre class="screen">curl -u admin:district "https://play.dhis2.org/dev/api/metadata/version?versionName=Version_2"</pre><p><span class="bold"><strong>Sample response:</strong></span>
        </p><pre class="screen">{
    "name": "Version_2",
    "created": "2016-06-30T05:59:33.238+0000",
    "lastUpdated": "2016-06-30T05:59:33.239+0000",
    "externalAccess": false,
    "displayName": "Version_2",
    "type": "BEST_EFFORT",
    "hashCode": "8050fb1a604e29d5566675c86d02d10b",
    "id": "SaNyhusVxBG"
}</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>/api/metadata/version/history - This api will return the list of all metadata
            versions of the system on which it is invoked.</p></li></ul></div><div class="table"><a name="d0e2841"></a><p class="title"><b>Table&nbsp;1.23.&nbsp;Query Parameters</b></p><div class="table-contents"><table class="table" summary="Query Parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>
                <p>Name</p>
              </th><th>
                <p>Required</p>
              </th><th>
                <p>Description</p>
              </th></tr></thead><tbody><tr><td>
                <p>baseline</p>
              </td><td>
                <p>false</p>
              </td><td>
                <p>If this parameter is not specified, it will return list of all metadata
                  versions. Otherwise we need to pass a versionName parameter of the form
                  "Version_&lt;id&gt;". It will then return the list of versions present
                  in the system which were created after the version name supplied as the query
                  parameter.</p>
              </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2882"></a>1.15.2.&nbsp;Get list of all metadata versions</h3></div></div></div><p><span class="bold"><strong>Example: Get the list of all versions in this system</strong></span></p><p><span class="bold"><strong>Sample request:</strong></span>
            </p><pre class="screen">curl -u admin:district "https://play.dhis2.org/dev/api/metadata/version/history"</pre><p><span class="bold"><strong>Sample response:</strong></span>
        </p><pre class="screen">{
    "metadataversions": [{
        "name": "Version_1",
        "type": "BEST_EFFORT",
        "created": "2016-06-30T05:54:41.139+0000",
        "id": "SjnhUp6r4hG",
        "hashCode": "fd1398ff7ec9fcfd5b59d523c8680798"
     }, {
         "name": "Version_2",
         "type": "BEST_EFFORT",
         "created": "2016-06-30T05:59:33.238+0000",
         "id": "SaNyhusVxBG",
         "hashCode": "8050fb1a604e29d5566675c86d02d10b"
     }, {
         "name": "Version_3",
         "type": "BEST_EFFORT",
         "created": "2016-06-30T06:01:23.680+0000",
         "id": "FVkGzSjAAYg",
         "hashCode": "70b779ea448b0da23d8ae0bd59af6333"
     }]
}</pre><p><span class="bold"><strong>Example: Get the list of all versions in this system created after "Version_2"</strong></span></p><p><span class="bold"><strong>Sample request:</strong></span>
            </p><pre class="screen">curl -u admin:district "https://play.dhis2.org/dev/api/metadata/version/history?baseline=Version_2"</pre><p><span class="bold"><strong>Sample response:</strong></span>
        </p><pre class="screen">{
    "metadataversions": [{
        "name": "Version_3",
        "type": "BEST_EFFORT",
        "created": "2016-06-30T06:01:23.680+0000",
        "id": "FVkGzSjAAYg",
        "hashCode": "70b779ea448b0da23d8ae0bd59af6333"
    }, {
        "name": "Version_4",
        "type": "BEST_EFFORT",
        "created": "2016-06-30T06:01:28.684+0000",
        "id": "Ayz2AEMB6ry",
        "hashCode": "848bf6edbaf4faeb7d1a1169445357b0"
    }]
 }</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>/api/metadata/version/create - This api will create the metadata version for the
            version type as specified in the parameter.</p></li></ul></div><div class="table"><a name="d0e2919"></a><p class="title"><b>Table&nbsp;1.24.&nbsp;Query Parameters</b></p><div class="table-contents"><table class="table" summary="Query Parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><thead><tr><th>
                <p>Name</p>
              </th><th>
                <p>Required</p>
              </th><th>
                <p>Description</p>
              </th></tr></thead><tbody><tr><td>
                <p>type</p>
              </td><td>
                <p>true</p>
              </td><td>
                <p>The type of metadata version which needs to be created.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>BEST_EFFORT</p></li><li class="listitem"><p>ATOMIC</p></li></ul></div>
              </td></tr></tbody></table></div></div><br class="table-break"><p>Users can select the type of metadata which needs to be created. Metadata Version type
        governs how the importer should treat the given version. This type will be used while
        importing the metadata. There are two types of metadata.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>BEST_EFFORT - This type suggests that missing references can be ignored and the
            importer can continue importing the metadata (e.g. missing data elements on a data
            element group import).</p></li><li class="listitem"><p>ATOMIC - ensures a strict type checking of the metadata references and the metadata
            import will fail if any of the references do not exist.</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="resources/images/admon/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>It's recommended to have ATOMIC type of versions to ensure that all systems
          (central and local) have the same metadata. Any missing reference is caught in the
          validation phase itself. Please see the importer details for better understanding.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2979"></a>1.15.3.&nbsp;Create metadata version</h3></div></div></div><p><span class="bold"><strong>Example: To create metadata version of type BEST_EFFORT</strong></span></p><p><span class="bold"><strong>Sample request:</strong></span>
            </p><pre class="screen">curl -X POST -u admin:district "https://play.dhis2.org/dev/api/metadata/version/create?type=BEST_EFFORT"</pre><p><span class="bold"><strong>Sample response:</strong></span>
        </p><pre class="screen">{
    "name": "Version_1",
    "created": "2016-06-30T05:54:41.139+0000",
    "lastUpdated": "2016-06-30T05:54:41.333+0000",
    "externalAccess": false,
    "publicAccess": "--------",
    "user": {
        "name": "John Traore",
        "created": "2013-04-18T17:15:08.407+0000",
        "lastUpdated": "2016-04-06T00:06:06.571+0000",
        "externalAccess": false,
        "displayName": "John Traore",
        "id": "xE7jOejl9FI"
    },
    "displayName": "Version_1",
    "type": "BEST_EFFORT",
    "hashCode": "fd1398ff7ec9fcfd5b59d523c8680798",
    "id": "SjnhUp6r4hG"
}</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>/api/metadata/version/{versionName}/data - This api will download the actual
            metadata specific to the version name passed as path parameter.</p></li><li class="listitem"><p>/api/metadata/version/{versionName}/data.gz - This api will download the actual
            metadata specific to the version name passed as path parameter in a compressed format
            (gzipped).</p></li></ul></div><div class="table"><a name="d0e3004"></a><p class="title"><b>Table&nbsp;1.25.&nbsp;Path parameters</b></p><div class="table-contents"><table class="table" summary="Path parameters" border="1"><colgroup><col class="c1"><col class="c2"><col class="newCol3"></colgroup><thead><tr><th>
                <p>Name</p>
              </th><th>
                <p>Required</p>
              </th><th>
                <p>Description</p>
              </th></tr></thead><tbody><tr><td>
                <p>versionName</p>
              </td><td>
                <p>true</p>
              </td><td>
                <p>Path parameter of the form "Version_&lt;id&gt;" so that the api&#8232;
                  downloads the specific version</p>
              </td></tr></tbody></table></div></div><br class="table-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3045"></a>1.15.4.&nbsp;Download metadata</h3></div></div></div><p><span class="bold"><strong>Example: Get the actual metadata for "Version_5"</strong></span></p><p><span class="bold"><strong>Sample request:</strong></span>
            </p><pre class="screen">curl -u admin:district "https://play.dhis2.org/dev/api/metadata/version/Version_5/data"</pre><p><span class="bold"><strong>Sample response:</strong></span>
        </p><pre class="screen">{
    "date": "2016-06-30T06:10:23.120+0000",
    "dataElements": [{
        "code": "ANC 5th Visit",
        "created": "2016-06-30T06:10:09.870+0000",
        "lastUpdated": "2016-06-30T06:10:09.870+0000",
        "name": "ANC 5th Visit",
        "id": "sCuZKDsix7Y",
        "shortName": "ANC 5th Visit ",
        "aggregationType": "SUM",
        "domainType": "AGGREGATE",
        "zeroIsSignificant": false,
        "valueType": "NUMBER",
        "categoryCombo": {
            "id": "p0KPaWEg3cf"
        },
        "user": {
            "id": "xE7jOejl9FI"
        }
    }]
}            </pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01s14.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch01.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch01s16.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">1.14.&nbsp;Metadata import&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="dhis2_developer_manual.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;1.16.&nbsp;Metadata Synchronization</td></tr></table></div></body></html>